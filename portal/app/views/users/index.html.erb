<h1>Your Lunch List</h1>

<table>
    <thead>
      <tr>
        <th></th>
        <th></th>
        <th></th>
      </tr>
    </thead>

  <tbody>

    <% people = Hash[@current_user.mutualfriends.sort_by{|k,v| v}.reverse] %>
      <% people.keys.each do |id| %>

      <% user = User.where(facebook_id: id ).first %>
      <tr>
    
        <% if (user != @current_user)%> <!-- && @current_user.facebook_friend?(user))%>-->
          <td><%= user.first_name %> <%= user.last_name %> 
            <%if user.class_year && user.res_college %>
              (<%= user.res_college %> '<%= user.class_year-2000  %>)
            <% end%>
          </td>
   
          <td><%#= "#{@current_user.mutualfriends[user.facebook_id]} Mutual Friends" %></td>
          <td><%= "#{people[id]} Mutual Friends" %></td>
      
          <% if @current_user.matchings.find_by(match_id: user.id, status: 'accepted') %>
            <td><%= "On Your Lunch List" %></td>
          <% elsif @current_user.matchings.find_by(match_id: user.id, status: 'pending') %>
            <td><%= "Request Sent" %></td>
          <% else %>
            <td><%= link_to 'Add to Lunch List', matchings_path(match_id: user.id), method: :post %></td>
          <% end %>

        <% end %>
      </tr>
    <% end %>
    
  </tbody>
</table>

<br>